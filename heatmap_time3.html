<!DOCTYPE html>
<head>    
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    
        <script>
            L_NO_TOUCH = false;
            L_DISABLE_3D = false;
        </script>
    
    <script src="https://cdn.jsdelivr.net/npm/leaflet@1.5.1/dist/leaflet.js"></script>
    <script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.5.1/dist/leaflet.css"/>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap-theme.min.css"/>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.css"/>
    <link rel="stylesheet" href="https://rawcdn.githack.com/python-visualization/folium/master/folium/templates/leaflet.awesome.rotate.css"/>
    <style>html, body {width: 100%;height: 100%;margin: 0;padding: 0;}</style>
    <style>#map {position:absolute;top:0;bottom:0;right:0;left:0;}</style>
    
            <meta name="viewport" content="width=device-width,
                initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
            <style>
                #map_17f7983a6c6b429f9ae0862f509923f3 {
                    position: relative;
                    width: 100.0%;
                    height: 100.0%;
                    left: 0.0%;
                    top: 0.0%;
                }
            </style>
        
    <script src="https://leaflet.github.io/Leaflet.heat/dist/leaflet-heat.js"></script>
    <script src="https://rawcdn.githack.com/nezasa/iso8601-js-period/master/iso8601.min.js"></script>
    <script src="https://rawcdn.githack.com/socib/Leaflet.TimeDimension/master/dist/leaflet.timedimension.min.js"></script>
    <script src="https://rawcdn.githack.com/python-visualization/folium/master/folium/templates/pa7_hm.min.js"></script>
    <script src="https://rawcdn.githack.com/pa7/heatmap.js/develop/plugins/leaflet-heatmap/leaflet-heatmap.js"></script>
    <link rel="stylesheet" href="http://apps.socib.es/Leaflet.TimeDimension/dist/leaflet.timedimension.control.min.css"/>
    
            <script>
                var TDHeatmap = L.TimeDimension.Layer.extend({

            initialize: function(data, options) {
                var heatmapCfg = {
                    radius: 15,
                    maxOpacity: 1.,
                    scaleRadius: false,
                    useLocalExtrema: false,
                    latField: 'lat',
                    lngField: 'lng',
                    valueField: 'count',
                    defaultWeight : 1,
                };
                heatmapCfg = $.extend({}, heatmapCfg, options.heatmapOptions || {});
                var layer = new HeatmapOverlay(heatmapCfg);
                L.TimeDimension.Layer.prototype.initialize.call(this, layer, options);
                this._currentLoadedTime = 0;
                this._currentTimeData = {
                    data: []
                    };
                this.data= data;
                this.defaultWeight = heatmapCfg.defaultWeight || 1;
            },
            onAdd: function(map) {
                L.TimeDimension.Layer.prototype.onAdd.call(this, map);
                map.addLayer(this._baseLayer);
                if (this._timeDimension) {
                    this._getDataForTime(this._timeDimension.getCurrentTime());
                }
            },
            _onNewTimeLoading: function(ev) {
                this._getDataForTime(ev.time);
                return;
            },
            isReady: function(time) {
                return (this._currentLoadedTime == time);
            },
            _update: function() {
                this._baseLayer.setData(this._currentTimeData);
                return true;
            },
            _getDataForTime: function(time) {
                    delete this._currentTimeData.data;
                    this._currentTimeData.data = [];
                    var data = this.data[time-1];
                    for (var i = 0; i < data.length; i++) {
                        this._currentTimeData.data.push({
                                lat: data[i][0],
                                lng: data[i][1],
                                count: data[i].length>2 ? data[i][2] : this.defaultWeight
                            });
                        }
                    this._currentLoadedTime = time;
                    if (this._timeDimension && time == this._timeDimension.getCurrentTime() && !this._timeDimension.isLoading()) {
                        this._update();
                    }
                    this.fire('timeload', {
                        time: time
                    });
                }
        });

        L.Control.TimeDimensionCustom = L.Control.TimeDimension.extend({
            initialize: function(index, options) {
                var playerOptions = {
                    buffer: 1,
                    minBufferReady: -1
                    };
                options.playerOptions = $.extend({}, playerOptions, options.playerOptions || {});
                L.Control.TimeDimension.prototype.initialize.call(this, options);
                this.index = index;
                },
            _getDisplayDateFormat: function(date){
                return this.index[date.getTime()-1];
                }
            });
            </script>
                
</head>
<body>    
    
            <div class="folium-map" id="map_17f7983a6c6b429f9ae0862f509923f3" ></div>
        
</body>
<script>    
    
            var map_17f7983a6c6b429f9ae0862f509923f3 = L.map(
                "map_17f7983a6c6b429f9ae0862f509923f3",
                {
                    center: [-12.0451206, -77.0981222],
                    crs: L.CRS.EPSG3857,
                    zoom: 10,
                    zoomControl: true,
                    preferCanvas: false,
                }
            );
            L.control.scale().addTo(map_17f7983a6c6b429f9ae0862f509923f3);

            

        
    
            var tile_layer_5ce310273bd14ba38accf1c988c01bb2 = L.tileLayer(
                "https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",
                {"attribution": "Data by \u0026copy; \u003ca href=\"http://openstreetmap.org\"\u003eOpenStreetMap\u003c/a\u003e, under \u003ca href=\"http://www.openstreetmap.org/copyright\"\u003eODbL\u003c/a\u003e.", "detectRetina": false, "maxNativeZoom": 18, "maxZoom": 18, "minZoom": 0, "noWrap": false, "opacity": 1, "subdomains": "abc", "tms": false}
            ).addTo(map_17f7983a6c6b429f9ae0862f509923f3);
        
    
            var heat_map_aac105d3bbf34bb383bb80b1a07d05a4 = L.heatLayer(
                [[-12.465838270568527, -76.77562517149076, 4297.0], [-12.40857690634422, -76.7673997103002, 637.0], [-12.369375315560305, -76.72414092412579, 4399.0], [-12.303641322994139, -76.70945046393867, 4408.0], [-12.269272112482037, -76.74378980891125, 10159.0], [-12.23425939225495, -76.80111215473715, 59666.0], [-12.219278691006945, -76.94527480943647, 207979.0], [-12.192645196680337, -77.00588844651965, 186661.0], [-12.170391569231331, -76.91898676639153, 222163.0], [-12.159990611313772, -76.8096200682664, 59681.0], [-12.157859572436667, -76.96650805858329, 221369.0], [-12.144029517199513, -77.02086252166971, 43154.0], [-12.126992081865467, -76.98430805575762, 315002.0], [-12.12091119822523, -77.02893363839817, 206442.0], [-12.113436313349052, -77.01298575464581, 107415.0], [-12.098980590205802, -77.03667204908952, 209362.0], [-12.097546336930353, -76.99520855857931, 157848.0], [-12.093838685128151, -77.06669441263178, 73965.0], [-12.088085662111641, -76.92572861799394, 149425.0], [-12.085791398649667, -77.03566665649426, 79974.0], [-12.078106416947637, -77.04820836035012, 121263.0], [-12.076463399337253, -76.7775258876874, 16512.0], [-12.076444914348116, -77.09006712194399, 152950.0], [-12.07508405755998, -77.0657431790067, 87810.0], [-12.07408654638946, -76.99723944658768, 59999.0], [-12.072332838654054, -77.01738563442595, 206230.0], [-12.07169510935483, -77.16278292738927, 4730.0], [-12.0702772897404, -77.11609792127338, 43325.0], [-12.06000628495593, -77.1099033268696, 52263.0], [-12.05916391335886, -77.050592430808, 90054.0], [-12.051031883614703, -77.04887413408566, 416447.0], [-12.043207022412027, -76.96314022497556, 159840.0], [-12.042884628664005, -77.09041770798744, 27086.0], [-12.040096913800292, -76.98740468044723, 131827.0], [-12.032570611011995, -76.87748019738281, 299611.0], [-12.023583817738157, -77.03267726109112, 118595.0], [-12.016752462821504, -77.12113300173183, 278238.0], [-11.99283077951611, -77.08841014051438, 402191.0], [-11.991636115890781, -76.76695134971935, 25026.0], [-11.987473195167228, -77.04604453074917, 135314.0], [-11.972422610615462, -77.07436697271612, 250470.0], [-11.958480272551448, -76.8013300576448, 99198.0], [-11.945966126345558, -76.97149491104699, 445103.0], [-11.92906458068247, -77.03890072479496, 269604.0], [-11.879124576335895, -77.13086366506253, 137091.0], [-11.872127803655285, -77.08665141053771, 163397.0], [-11.854339462423894, -77.12055569377657, 23216.0], [-11.807383846418228, -76.97292708450377, 158302.0], [-11.805006691433833, -77.16325275355963, 14497.0], [-11.702534302923418, -77.09580730704306, 32178.0]],
                {"blur": 15, "max": 1.0, "maxZoom": 13, "minOpacity": 0.5, "radius": 8}
            ).addTo(map_17f7983a6c6b429f9ae0862f509923f3);
        
    

            var times = [1, 2, 3];

            map_17f7983a6c6b429f9ae0862f509923f3.timeDimension = L.timeDimension(
                {times : times, currentTime: new Date(1)}
            );

            var heat_map_48b65279e4ef4d25ba44d94741d12132Control = new L.Control.TimeDimensionCustom(['1', '2', '3'], {
                autoPlay: false,
                backwardButton: true,
                displayDate: true,
                forwardButton: true,
                limitMinimumRange: 5,
                limitSliders: true,
                loopButton: true,
                maxSpeed: 10,
                minSpeed: 0.1,
                playButton: true,
                playReverseButton: true,
                position: "bottomleft",
                speedSlider: true,
                speedStep: 0.1,
                styleNS: "leaflet-control-timecontrol",
                timeSlider: true,
                timeSliderDrapUpdate: false,
                timeSteps: 1
                })
                .addTo(map_17f7983a6c6b429f9ae0862f509923f3);

                var heat_map_48b65279e4ef4d25ba44d94741d12132 = new TDHeatmap([[[-12.465838270568527, -76.77562517149076, 1256.0], [-12.40857690634422, -76.7673997103002, 209.0], [-12.369375315560305, -76.72414092412579, 1408.0], [-12.303641322994139, -76.70945046393867, 1735.0], [-12.269272112482037, -76.74378980891125, 3575.0], [-12.23425939225495, -76.80111215473715, 12860.0], [-12.219278691006945, -76.94527480943647, 85889.0], [-12.192645196680337, -77.00588844651965, 67519.0], [-12.170391569231331, -76.91898676639153, 102131.0], [-12.159990611313772, -76.8096200682664, 26209.0], [-12.157859572436667, -76.96650805858329, 93355.0], [-12.144029517199513, -77.02086252166971, 11796.0], [-12.126992081865467, -76.98430805575762, 98651.0], [-12.12091119822523, -77.02893363839817, 28780.0], [-12.113436313349052, -77.01298575464581, 28834.0], [-12.098980590205802, -77.03667204908952, 15695.0], [-12.097546336930353, -76.99520855857931, 38923.0], [-12.093838685128151, -77.06669441263178, 21787.0], [-12.088085662111641, -76.92572861799394, 42302.0], [-12.085791398649667, -77.03566665649426, 18578.0], [-12.078106416947637, -77.04820836035012, 25037.0], [-12.076463399337253, -76.7775258876874, 6992.0], [-12.076444914348116, -77.09006712194399, 51540.0], [-12.07508405755998, -77.0657431790067, 30775.0], [-12.07408654638946, -76.99723944658768, 16835.0], [-12.072332838654054, -77.01738563442595, 34366.0], [-12.07169510935483, -77.16278292738927, 1039.0], [-12.0702772897404, -77.11609792127338, 18801.0], [-12.06000628495593, -77.1099033268696, 19975.0], [-12.05916391335886, -77.050592430808, 27146.0], [-12.051031883614703, -77.04887413408566, 60870.0], [-12.043207022412027, -76.96314022497556, 49794.0], [-12.042884628664005, -77.09041770798744, 10539.0], [-12.040096913800292, -76.98740468044723, 57286.0], [-12.032570611011995, -76.87748019738281, 109358.0], [-12.023583817738157, -77.03267726109112, 47211.0], [-12.016752462821504, -77.12113300173183, 76242.0], [-11.99283077951611, -77.08841014051438, 174378.0], [-11.991636115890781, -76.76695134971935, 10137.0], [-11.987473195167228, -77.04604453074917, 51230.0], [-11.972422610615462, -77.07436697271612, 88204.0], [-11.958480272551448, -76.8013300576448, 36030.0], [-11.945966126345558, -76.97149491104699, 201314.0], [-11.92906458068247, -77.03890072479496, 115368.0], [-11.879124576335895, -77.13086366506253, 60017.0], [-11.872127803655285, -77.08665141053771, 64105.0], [-11.854339462423894, -77.12055569377657, 11218.0], [-11.807383846418228, -76.97292708450377, 72064.0], [-11.805006691433833, -77.16325275355963, 6878.0], [-11.702534302923418, -77.09580730704306, 12550.0]], [[-12.465838270568527, -76.77562517149076, 1785.0], [-12.40857690634422, -76.7673997103002, 219.0], [-12.369375315560305, -76.72414092412579, 1583.0], [-12.303641322994139, -76.70945046393867, 938.0], [-12.269272112482037, -76.74378980891125, 3009.0], [-12.23425939225495, -76.80111215473715, 33946.0], [-12.219278691006945, -76.94527480943647, 36201.0], [-12.192645196680337, -77.00588844651965, 51623.0], [-12.170391569231331, -76.91898676639153, 17901.0], [-12.159990611313772, -76.8096200682664, 7263.0], [-12.157859572436667, -76.96650805858329, 34659.0], [-12.144029517199513, -77.02086252166971, 19562.0], [-12.126992081865467, -76.98430805575762, 117700.0], [-12.12091119822523, -77.02893363839817, 148882.0], [-12.113436313349052, -77.01298575464581, 49747.0], [-12.098980590205802, -77.03667204908952, 177972.0], [-12.097546336930353, -76.99520855857931, 80002.0], [-12.093838685128151, -77.06669441263178, 30391.0], [-12.088085662111641, -76.92572861799394, 64821.0], [-12.085791398649667, -77.03566665649426, 42818.0], [-12.078106416947637, -77.04820836035012, 71189.0], [-12.076463399337253, -76.7775258876874, 2528.0], [-12.076444914348116, -77.09006712194399, 49870.0], [-12.07508405755998, -77.0657431790067, 26260.0], [-12.07408654638946, -76.99723944658768, 26329.0], [-12.072332838654054, -77.01738563442595, 137498.0], [-12.07169510935483, -77.16278292738927, 2652.0], [-12.0702772897404, -77.11609792127338, 5723.0], [-12.06000628495593, -77.1099033268696, 12313.0], [-12.05916391335886, -77.050592430808, 35762.0], [-12.051031883614703, -77.04887413408566, 294707.0], [-12.043207022412027, -76.96314022497556, 60252.0], [-12.042884628664005, -77.09041770798744, 6008.0], [-12.040096913800292, -76.98740468044723, 17255.0], [-12.032570611011995, -76.87748019738281, 80895.0], [-12.023583817738157, -77.03267726109112, 24173.0], [-12.016752462821504, -77.12113300173183, 125754.0], [-11.99283077951611, -77.08841014051438, 53435.0], [-11.991636115890781, -76.76695134971935, 4752.0], [-11.987473195167228, -77.04604453074917, 32854.0], [-11.972422610615462, -77.07436697271612, 74062.0], [-11.958480272551448, -76.8013300576448, 27138.0], [-11.945966126345558, -76.97149491104699, 42475.0], [-11.92906458068247, -77.03890072479496, 38868.0], [-11.879124576335895, -77.13086366506253, 17057.0], [-11.872127803655285, -77.08665141053771, 35187.0], [-11.854339462423894, -77.12055569377657, 780.0], [-11.807383846418228, -76.97292708450377, 14174.0], [-11.805006691433833, -77.16325275355963, 741.0], [-11.702534302923418, -77.09580730704306, 7078.0]], [[-12.465838270568527, -76.77562517149076, 1256.0], [-12.40857690634422, -76.7673997103002, 209.0], [-12.369375315560305, -76.72414092412579, 1408.0], [-12.303641322994139, -76.70945046393867, 1735.0], [-12.269272112482037, -76.74378980891125, 3575.0], [-12.23425939225495, -76.80111215473715, 12860.0], [-12.219278691006945, -76.94527480943647, 85889.0], [-12.192645196680337, -77.00588844651965, 67519.0], [-12.170391569231331, -76.91898676639153, 102131.0], [-12.159990611313772, -76.8096200682664, 26209.0], [-12.157859572436667, -76.96650805858329, 93355.0], [-12.144029517199513, -77.02086252166971, 11796.0], [-12.126992081865467, -76.98430805575762, 98651.0], [-12.12091119822523, -77.02893363839817, 28780.0], [-12.113436313349052, -77.01298575464581, 28834.0], [-12.098980590205802, -77.03667204908952, 15695.0], [-12.097546336930353, -76.99520855857931, 38923.0], [-12.093838685128151, -77.06669441263178, 21787.0], [-12.088085662111641, -76.92572861799394, 42302.0], [-12.085791398649667, -77.03566665649426, 18578.0], [-12.078106416947637, -77.04820836035012, 25037.0], [-12.076463399337253, -76.7775258876874, 6992.0], [-12.076444914348116, -77.09006712194399, 51540.0], [-12.07508405755998, -77.0657431790067, 30775.0], [-12.07408654638946, -76.99723944658768, 16835.0], [-12.072332838654054, -77.01738563442595, 34366.0], [-12.07169510935483, -77.16278292738927, 1039.0], [-12.0702772897404, -77.11609792127338, 18801.0], [-12.06000628495593, -77.1099033268696, 19975.0], [-12.05916391335886, -77.050592430808, 27146.0], [-12.051031883614703, -77.04887413408566, 60870.0], [-12.043207022412027, -76.96314022497556, 49794.0], [-12.042884628664005, -77.09041770798744, 10539.0], [-12.040096913800292, -76.98740468044723, 57286.0], [-12.032570611011995, -76.87748019738281, 109358.0], [-12.023583817738157, -77.03267726109112, 47211.0], [-12.016752462821504, -77.12113300173183, 76242.0], [-11.99283077951611, -77.08841014051438, 174378.0], [-11.991636115890781, -76.76695134971935, 10137.0], [-11.987473195167228, -77.04604453074917, 51230.0], [-11.972422610615462, -77.07436697271612, 88204.0], [-11.958480272551448, -76.8013300576448, 36030.0], [-11.945966126345558, -76.97149491104699, 201314.0], [-11.92906458068247, -77.03890072479496, 115368.0], [-11.879124576335895, -77.13086366506253, 60017.0], [-11.872127803655285, -77.08665141053771, 64105.0], [-11.854339462423894, -77.12055569377657, 11218.0], [-11.807383846418228, -76.97292708450377, 72064.0], [-11.805006691433833, -77.16325275355963, 6878.0], [-11.702534302923418, -77.09580730704306, 12550.0]]],
                {heatmapOptions: {
                        radius: 20,
                        minOpacity: 0.5,
                        maxOpacity: 1,
                        scaleRadius: false,
                        useLocalExtrema: true,
                        defaultWeight: 1,
                        gradient: {0.2: 'blue', 0.4: 'lime', 0.6: 'orange', 1: 'red'}
                    }
                })
                .addTo(map_17f7983a6c6b429f9ae0862f509923f3);

        
</script>